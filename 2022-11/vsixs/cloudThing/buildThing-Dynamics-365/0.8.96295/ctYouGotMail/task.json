{"id":"9C478404-73E4-4A5F-B1A7-66AF593711E8","name":" You've got mail!","friendlyName":":: buildThings ::  You've Got Mail!","description":"Use this task to configure, authorise, test and enable mailboxes associated with Queues or Users","author":"cloudThing Ltd","helpMarkDown":"<p>Supply a single email address or multiple email addresses separated by semi-colons. Select to use either the server default profile for incoming/outgoing/appointment settings, or specify them directly in this task. The mailbox for each given email address will be updated to use those values.</p><p>Optionally the email addresses can be authorised and a 'test and enable' scheduled automatically. </p><p>Note that most D365 systems default to only allowing an Office365 admin to enable mailboxes. </p><p>For best results, ensure your specified Target Org Connection is the security context of an O365 or global tenancy admin.","category":"Utility","visibility":["Build","Release"],"demands":[],"version":{"Major":"0","Minor":"8","Patch":"96295"},"minimumAgentVersion":"1.95.0","instanceNameFormat":"ctYouGotMail $(message)","inputs":[{"name":"targetOrg","type":"string","label":"Target Org Connection String","defaultValue":"AuthType=OAuth;Username=<USERNAME>; Password=<PASSWORD>; Url=<URL>; RequireNewInstance=True; AppId=51f81489-12ee-4a9e-aaae-a2591f45987d; RedirectUri=app://58145B91-0C36-4500-8554-080854F2AC97;","required":true,"helpMarkDown":"The connection string to the target organisation. OAuth, ClientSecret and ClientCertificate are supported. See <a href='https://docs.microsoft.com/en-us/powerapps/developer/data-platform/xrm-tooling/use-connection-strings-xrm-tooling-connect' target='_blank'>Dataverse - Connection Strings</a>"},{"name":"EmailAddresses","type":"multiLine","label":"Email Address(es)","defaultValue":"","required":true,"properties":{"resizable":"true","rows":"10"},"helpMarkDown":"The email address(es) of the queue or user to enable. Use semicolons to separate multiple email addresses to process. <br/> e.g. jim.kirk@starfleet.com;lenny.mccoy@starfleet.com"},{"name":"setMailboxToDefaults","type":"boolean","label":"Set the mailbox(es) to the default profile","defaultValue":false,"required":true,"helpMarkDown":"Use the system defaults for the 3 mailbox settings for 'Incoming Email Profile', 'Outbound Email Profile' and 'Appointments, Contacts and Tasks'"},{"name":"incomingEmailSetting","type":"pickList","label":"Incoming Email Profile","defaultValue":"ServerSideSynchronization","visibleRule":"setMailboxToDefaults != true","required":true,"helpMarkDown":"Set the inbound email profile for the mailbox","options":{"MicrosoftDynamics365forOutlook":"Microsoft Dynamics 365 for Outlook","ServerSideSynchronization":"Server Side Sync or Mail Router","ForwardMailBox":"Forward Mailbox","None":"None"}},{"name":"outboundEmailSetting","type":"pickList","label":"Outbound Email Profile","defaultValue":"ServerSideSynchronization","visibleRule":"setMailboxToDefaults != true","required":true,"helpMarkDown":"Set the outbound email profile for the mailbox","options":{"MicrosoftDynamics365forOutlook":"Microsoft Dynamics 365 for Outlook","ServerSideSynchronization":"Server Side Sync or Mail Router","None":"None"}},{"name":"apptTasksSetting","type":"pickList","label":"Appointments, Contacts and Tasks","defaultValue":"None","visibleRule":"setMailboxToDefaults != true","required":true,"helpMarkDown":"Set the outbound email profile for the mailbox","options":{"MicrosoftDynamics365forOutlook":"Microsoft Dynamics 365 for Outlook","ServerSideSynchronization":"Server Side Sync or Mail Router","None":"None"}},{"name":"resetQueueEmail","type":"boolean","label":"Reset queue email addresses","defaultValue":false,"required":true,"helpMarkDown":"<p>After environments have been copied over or reset from backups it's possible that queue email addresses get into a 'dead' state. Resetting the email address resolves this issue.</p><p>Setting this flag field to true will change the queue email address to temp@temp.com, save it, and then immediately change the email address back to what it was. This triggers a few internal processes in D365 which resolves the dead state of the email queue.</p>"},{"name":"approveEmail","type":"boolean","label":"Approve the email of the queue or user to be able to use the emailrouter","defaultValue":true,"required":true,"helpMarkDown":"<p>Approve the email address of the user.</p><p>Note that by default D365 requires an Office365 admin to do this. For best results ensure the connection context is a global admin or exchange admin in your tenancy.</p>"},{"name":"scheduleTest","type":"boolean","label":"Schedule 'test and enable' on the mailbox","defaultValue":true,"required":true,"helpMarkDown":"<p>Setting this to true will try enable the mailbox and send a test message. The default for D365 is that if the email address is not approved by an Office 365 admin the test will fail.</p><p>This default can be turned off in D365 adv settings. See <a href='https://d365demystified.com/2020/04/09/enable-disable-the-need-to-approve-email-for-mailboxes-in-dynamics-365-crm-ce/' target='_blank'>Enable/Disable the need to approve email for mailboxes in D365</a>"}],"execution":{"PowerShell3":{"target":"ctYouGotMail.ps1"}}}
