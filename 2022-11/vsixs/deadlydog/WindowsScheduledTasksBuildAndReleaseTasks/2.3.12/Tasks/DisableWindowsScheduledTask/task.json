{"id":"1F049C80-A651-1293-96D1-171F053C2144","name":"DisableWindowsScheduledTask","friendlyName":"Windows Scheduled Task - Disable","description":"Disables a Windows Scheduled Task","helpMarkDown":"[More Information](https://github.com/deadlydog/AzureDevOps.WindowsScheduledTasks)","category":"Utility","visibility":["Build","Release"],"author":"Daniel Schroeder","version":{"Major":"2","Minor":"3","Patch":"12"},"instanceNameFormat":"Disable Windows Scheduled Task '$(ScheduledTaskFullName)'","groups":[{"name":"ScheduledTaskSettings","displayName":"Scheduled Task Settings","isExpanded":true},{"name":"ServerSettings","displayName":"Server Settings","isExpanded":true}],"inputs":[{"name":"ScheduledTaskFullName","type":"string","label":"Scheduled Task Name","required":true,"defaultValue":"","helpMarkDown":"The full path of the Scheduled Task to disable on the server(s).<br />If the Scheduled Task is installed in a directory, the directory (or directories) must also be included in the path.<br />e.g. `MyTasks\\TaskToDisable`<br /><br />Wildcards are supported as well.<br />For example, the following would all match on the `MyTasks\\TaskToDisable` task:<br />`*\\TaskToDisable`<br />`MyTasks\\TaskTo*`<br />`*\\*Disable`<br />`MyTasks\\Task*Disable`<br /><br />NOTE: Be very careful when using wildcards, since if multiple Scheduled Tasks are found to match they pattern, they will all be disabled.","groupName":"ScheduledTaskSettings"},{"name":"ComputerNames","type":"string","label":"Computer Names","required":false,"defaultValue":"","helpMarkDown":"A comma-separated list of computers to connect to and disable the Scheduled Task on.<br /><br />Leave blank to have it run on the agent's local computer.","groupName":"ServerSettings"},{"name":"Username","type":"string","label":"Username","required":false,"defaultValue":"","helpMarkDown":"The username to use when connecting to the computers and disabling the Scheduled Task.<br /><br />Leave blank to use the identity that the agent is running as.","groupName":"ServerSettings"},{"name":"Password","type":"string","label":"Password","required":false,"defaultValue":"","helpMarkDown":"The password to use when connecting to the computers and disabling the Scheduled Task.<br /><br />As a best practice, a secret variable should be passed in here so that other users cannot see the password in plain text.<br /><br />Leave blank to use the identity that the agent is running as.","groupName":"ServerSettings"},{"name":"AuthenticationOptions","type":"radio","label":"Authentication","required":true,"defaultValue":"Default","helpMarkDown":"The authentication mechanism to use to connect to remote servers.<br /><br />CredSSP lets an application delegate the credentials from the client to the target server for remote authentication. In order to use this setting, you may need to first run the PowerShell command 'Enable-WSManCredSSP -Role Server -Force' on the remote servers to enable them to accept requests that use CredSSP. If this is not enabled on the remote server the task may get 'Access is denied' or 'Authentication mechanism' errors when connecting to the remote server.<br /><br />Some authentication options require you to leave the 'Username' and 'Password' fields empty. For more information on CredSSP and the other supported authentication mechanisms, see the docs [here](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/invoke-command?view=powershell-3.0) and [here](https://docs.microsoft.com/en-us/windows/desktop/winrm/authentication-for-remote-connections).","options":{"Default":"Default","Basic":"Basic","CredSSP":"CredSSP","Digest":"Digest","Kerberos":"Kerberos","Negotiate":"Negotiate","NegotiateWithImplicitCredential":"NegotiateWithImplicitCredential"},"groupName":"ServerSettings"},{"name":"ProtocolOptions","type":"radio","label":"Protocol","required":true,"defaultValue":"HTTP","helpMarkDown":"Select the network protocol to use for the WinRM connection with the machine(s). The default is HTTP.","options":{"HTTP":"HTTP","HTTPS":"HTTPS"},"groupName":"ServerSettings"},{"name":"ProtocolSkipCaCheckString","type":"boolean","label":"Skip CA Check","visibleRule":"ProtocolOptions = HTTPS","required":false,"defaultValue":"false","helpMarkDown":"Select this so the client does not validate that the server certificate is signed by a trusted certification authority (CA).<br /><br />Use this option only when the remote computer is trusted by using another mechanism, such as when the remote computer is part of a network that is physically secure and isolated or when the remote computer is listed as a trusted host in a WinRM configuration.<br /><br />[More information](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/new-pssessionoption?view=powershell-3.0)","groupName":"ServerSettings"},{"name":"ProtocolSkipCnCheckString","type":"boolean","label":"Skip CN Check","visibleRule":"ProtocolOptions = HTTPS","required":false,"defaultValue":"false","helpMarkDown":"Select this so the certificate common name (CN) of the server does not have to match the host name of the server.<br /><br />Use this option only for trusted computers.<br /><br />[More information](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/new-pssessionoption?view=powershell-3.0)","groupName":"ServerSettings"},{"name":"ProtocolSkipRevocationCheckString","type":"boolean","label":"Skip Revocation Check","visibleRule":"ProtocolOptions = HTTPS","required":false,"defaultValue":"false","helpMarkDown":"Select this to not validate the revocation status of the server certificate.<br /><br />[More information](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/new-pssessionoption?view=powershell-3.0)","groupName":"ServerSettings"}],"execution":{"PowerShell":{"target":"$(currentDirectory)/Code/Disable-WindowsScheduledTask-TaskEntryPoint.ps1","argumentFormat":"","workingDirectory":"$(currentDirectory)"}}}
