{
  "id": "46949bb4-5c41-47a8-9aea-c2082a974107",
  "name": "ManageAzureWebAppDirectoriesTask",
  "friendlyName": "Azure App Service - Partial package deployment to support Micro Frontend architecture",
  "description": "Upload the partial or full Web App deployment package on Azure Web App through Kudu Rest API.  Partial deployment is helpful in the case of Micro frontend applications where we need control on which module can be deployed on the environment.  This extension will take the backup of existing wwwroot directory if Azure storage settings are configured.",
  "helpMarkDown": "Version: 1.0.0",
  "category": "Deploy",
  "author": "Emtec Inc",
  "version": {
    "Major": 1,
    "Minor": 0,
    "Patch": 0
  },
  "visibility": [
    "Build",
    "Release"
  ],
  "demands": [ "azureps" ],
  "minimumAgentVersion": "1.102.0",
  "groups": [
    {
      "name": "Advanced",
      "displayName": "Advanced",
      "isExpanded": false
    }
  ],
  "inputs": [
    {
      "name": "ConnectedServiceName",
      "type": "connectedService:AzureRM",
      "label": "Azure subscription",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Select the Azure Resource Manager subscription for the deployment."
    },
    {
      "name": "WebAppName",
      "type": "pickList",
      "label": "App Service name",
      "defaultValue": "",
      "required": true,
      "properties": {
        "EditableOptions": "True"
      },
      "helpMarkDown": "Enter or Select the name of an existing Azure App Service."
    },
    {
      "name": "SourceFolder",
      "type": "filePath",
      "label": "Package or Folder",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "File path to the package or a folder containing app service contents generated by MSBuild or a compressed zip."
    },
    {
      "name": "filePath",
      "type": "string",
      "label": "Folders to Publish",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "For partial package deployment, enter the comma-separated list of directories path (relative to wwwroot folder) of your deployment package.<br /> You can also provide the path as '/' if you want to upload and replace the entire package"
    },
    {
      "name": "alternativeKuduUrl",
      "type": "string",
      "label": "Alternative Kudu URL",
      "groupName": "Advanced",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "value of SCM endpoint if it is not website.scm.azurewebsites.net (fill in only last part starting with scm.)"
    },
    {
      "name": "slotName",
      "type": "string",
      "label": "Slot",
      "groupName": "Advanced",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "value of slot name if deploying an app to a slot (provide value only deploying the application to a slot.)"
    },
    {
      "name": "storageAccountName",
      "type": "pickList",
      "label": "RM Storage Account",
      "groupName": "Advanced",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Specify a pre-existing ARM storage account for uploading the backup of the current wwwroot folder.<br /> Note: The selected azure resource manager should have access to this storage resource"
    },
    {
      "name": "storageContainerName",
      "type": "string",
      "label": "Container Name",
      "groupName": "Advanced",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Name of the Container for uploading the backup files. Container with the given name must exist in the specified storage account. <br /> Note: The selected azure resource manager should have access to this storage resource"
    }
  ],
  "dataSourceBindings": [
    {
      "target": "storageAccountName",
      "endpointId": "$(ConnectedServiceName)",
      "dataSourceName": "AzureStorageAccountRM"
    },
    {
      "target": "WebAppName",
      "endpointId": "$(ConnectedServiceName)",
      "dataSourceName": "AzureRMWebAppNames"
    }
  ],
  "instanceNameFormat": "Azure App Service - Partial package deployment to support Micro Frontend architecture",
  "execution": {
    "PowerShell3": {
      "target": "$(currentDirectory)\\AzureAppServiceFileDeploy.ps1"
    }
  }
}