{"$schema":"https://raw.githubusercontent.com/Microsoft/azure-pipelines-task-lib/master/tasks.schema.json","id":"d442a3ea-a167-49c8-894b-9358e78cceae","name":"GoogleCloudMemorystore","friendlyName":"Google Cloud Memorystore","description":"Creates and manages Redis instances on the Google Cloud Platform.","helpUrl":"https://github.com/nexsolab/azure-devops-google-cloud-tools","helpMarkDown":"[Learn more about this task](https://github.com/nexsolab/azure-devops-google-cloud-tools#readme) or [see the Cloud Memorystore documentation](https://cloud.google.com/memorystore/docs/redis/apis)","category":"Deploy","runsOn":["Agent"],"visibility":["Build","Release"],"author":"Gabriel Anderson","instanceNameFormat":"Cloud Memorystore - $(operation) $(instanceName)","version":{"Major":0,"Minor":"4","Patch":"1"},"groups":[{"name":"RedisConfig","displayName":"Redis Custom Config","isExpanded":true,"visibleRule":"operation = create"},{"name":"GCPResourceOptions","displayName":"Google Cloud resource options","isExpanded":false,"visibleRule":"operation = create"}],"inputs":[{"name":"authenticationMethod","type":"pickList","label":"Authentication method","defaultValue":"serviceAccount","options":{"serviceAccount":"Service Account (Connected Service)","jsonFile":"JSON file credentials"},"helpMarkDown":"Authorization requires the following Google IAM roles:<br />`roles/dns.admin`"},{"name":"SCserviceAccount","type":"connectedService:GoogleCloudServiceEndpoint","label":"Google Cloud Service Account","defaultValue":"","required":true,"helpMarkDown":"Select the Service Account that should be used for the next steps","visibleRule":"authenticationMethod = serviceAccount"},{"name":"jsonCredentials","type":"secureFile","label":"JSON Credentials file","required":true,"defaultValue":"","helpMarkDown":"Select the JSON file with the credentials, see for more information","visibleRule":"authenticationMethod = jsonFile"},{"name":"operation","type":"pickList","label":"Operation","required":true,"defaultValue":"create","options":{"create":"Create/Update instance","delete":"Delete instance","failover":"Failover instance","upgrade":"Upgrade instance version"}},{"name":"gcpRegion","type":"pickList","label":"Region","defaultValue":"","required":true,"options":{"asia-east1":"Taiwan (asia-east1)","asia-east2":"Hong Kong (asia-east2)","asia-northeast1":"Tokyo (asia-northeast1)","asia-northeast2":"Osaka (asia-northeast2)","asia-northeast3":"Seoul (asia-northeast3)","asia-south1":"Mumbai (asia-south1)","asia-southeast1":"Singapore (asia-southeast1)","asia-southeast2":"Jakarta (asia-southeast2)","australia-southeast1":"Sydney (australia-southeast1)","europe-north1":"Finland (europe-north1)","europe-west1":"Belgium (europe-west1)","europe-west2":"London (europe-west2)","europe-west3":"Frankfurt (europe-west3)","europe-west4":"Netherlands (europe-west4)","europe-west6":"Zurich (europe-west6)","northamerica-northeast1":"Montréal (northamerica-northeast1)","southamerica-east1":"São Paulo (southamerica-east1)","us-central1":"Iowa (us-central1)","us-east1":"South Carolina (us-east1)","us-east4":"Northern Virginia (us-east4)","us-west1":"Oregon (us-west1)","us-west2":"Los Angeles (us-west2)","us-west3":"Salt Lake City (us-west3)","us-west4":"Las Vegas (us-west4)"},"properties":{"EditableOptions":"True"},"helpMarkDown":"Enter or select the region where this function should be created."},{"name":"gcpLabels","type":"multiLine","label":"Resource labels","groupName":"GCPResourceOptions","defaultValue":"","required":false,"helpMarkDown":"Put JSON or use the editor.<br />**Keys** must start with a lowercase character and contain only hyphens (\\-), underscores (\\_), lowercase characters, and numbers.<br />**Values** must contain only hyphens (\\-), underscores (\\_), lowercase characters, and numbers.","properties":{"editorExtension":"ms.vss-services-azure.parameters-grid"}},{"name":"instanceName","type":"string","label":"Instance name","defaultValue":"","required":true,"helpMarkDown":"Use lowercase letters, numbers and hyphens. Start with a letter."},{"name":"instanceDisplayName","type":"string","label":"Display name","defaultValue":"","required":false,"helpMarkDown":"An arbitrary and optional user-provided name for the instance.","visibleRule":"operation = create"},{"name":"instanceTier","type":"radio","label":"Tier","defaultValue":"BASIC","required":true,"options":{"BASIC":"BASIC tier: standalone instance","STANDARD":"STANDARD_HA tier: highly available primary/replica instances"},"helpMarkDown":"A list of IDs of GCP regions where messages that are published to the topic may be persisted in storage. Messages published by publishers running in non-allowed GCP regions (or running outside of GCP altogether) will be routed for storage in one of the allowed regions. An empty list means that no regions are allowed, and is not a valid configuration.","visibleRule":"operation = create"},{"name":"instanceMemorySize","type":"string","label":"Redis memory size in GiB.","defaultValue":"1","required":true,"visibleRule":"operation = create"},{"name":"instanceNetwork","type":"string","label":"Authorized network","defaultValue":"","required":false,"visibleRule":"operation = create","helpMarkDown":"The full name of the Google Compute Engine [network](https://cloud.google.com/compute/docs/networks-and-firewalls#networks) to which the instance is connected. If left unspecified, the default network will be used."},{"name":"instanceConnectMode","type":"radio","label":"Connection mode","defaultValue":"DIRECT","required":true,"options":{"DIRECT":"Connect via direct peering to the Memorystore for Redis hosted service","PRIVATE":"Connect your Memorystore for Redis instance using Private Service Access"},"visibleRule":"operation = create"},{"name":"instanceZone","type":"string","label":"Instance zone","defaultValue":"","required":false,"helpMarkDown":"The zone where the instance will be provisioned. If not provided, the service will choose a zone for the instance. For STANDARD_HA tier, instances will be created across two zones for protection against zonal failures.","visibleRule":"operation = create"},{"name":"instanceAlternativeZone","type":"string","label":"Alternative zone (in case of failures)","defaultValue":"","required":false,"helpMarkDown":"Optional. Only applicable to STANDARD_HA tier which protects the instance against zonal failures by provisioning it across two zones. If provided, it must be a different zone from the one provided in `Instance zone`","visibleRule":"operation = create && instanceTier = STANDARD"},{"name":"instanceIpRange","type":"string","label":"Reserved IP Range","defaultValue":"","required":false,"helpMarkDown":"Optional. The CIDR range of internal addresses that are reserved for this instance. If not provided, the service will choose an unused /29 block, for example, 10.0.0.0/29 or 192.168.0.0/29. Ranges must be unique and non-overlapping with existing subnets in an authorized network.","visibleRule":"operation = create"},{"name":"redisVersion","type":"radio","label":"The version of Redis software","defaultValue":"latest","required":true,"options":{"latest":"Latest (v4)","REDIS32":"3.2","REDIS40":"4.0","REDIS50":"5.0"},"visibleRule":"operation = create || operation = upgrade","groupName":"RedisConfig"},{"name":"redisMaxMemoryPolicy","type":"pickList","label":"Max Memory Policy","defaultValue":"volatile-lru","required":false,"options":{"noeviction":"Don't expire at all, just return an error on write operations (noeviction)","allkeys-random":"Evicts random keys from the entire keyspace (allkeys-random)","allkeys-lru":"Evicts the least recently used (LRU) keys from the entire keyset (allkeys-lru)","allkeys-lfu":"Evicts the least frequently used (LFU) keys from the entire keyset. (v4+) (allkeys-lfu)","volatile-random":"Evicts random keys from among those set with TTL expirations (volatile-random)","volatile-lru":"Evicts the least recently used (LRU) keys that are set with TTL expirations (volatile-lru)","volatile-lfu":"Evicts the least-frequently-used keys that are set with TTL (time to live) expirations (v4+) (volatile-lfu)","volatile-ttl":"Evicts the keys with the shortest TTL from among those set with TTL expirations (volatile-ttl)"},"helpMarkDown":"How Redis will select what to remove when maxmemory is reached.","visibleRule":"operation = create","groupName":"RedisConfig"},{"name":"redisNotifyEvents","type":"string","label":"Enable event notification","defaultValue":"","required":false,"helpMarkDown":"`notify-keyspace-events`: Redis can notify Pub/Sub clients about events happening in the key space. [Learn more](https://cloud.google.com/memorystore/docs/redis/redis-configs#modifiable_configuration_parameters)","visibleRule":"operation = create","groupName":"RedisConfig"},{"name":"redisActiveDefrag","type":"boolean","label":"Enable active defragmentation","defaultValue":false,"required":false,"helpMarkDown":"`activedefrag`: Active (online) defragmentation allows a Redis server to compact the spaces left between small allocations and deallocations of data in memory, thus allowing to reclaim back memory.","visibleRule":"operation = create && redisVersion != REDIS32","groupName":"RedisConfig"},{"name":"redisLfuDecayTime","type":"string","label":"LFU: Decay time (in minutes)","defaultValue":"1","required":false,"visibleRule":"operation = create && redisVersion != REDIS32","helpMarkDown":"`lfu-decay-time`: The time that must elapse in order for the key counter to be divided by two (or decremented if it has a value less <= 10)<br>The default value for the lfu-decay-time is 1. A Special value of 0 means to decay the counter every time it happens to be scanned.","groupName":"RedisConfig"},{"name":"redisLfuLogFactor","type":"string","label":"LFU: Log Factor (in minutes)","defaultValue":"10","required":false,"visibleRule":"operation = create && redisVersion != REDIS32","helpMarkDown":"`lfu-log-factor`: The LFU counter is just 8 bits per key, it's maximum value is 255, so Redis uses a probabilistic increment with logarithmic behavior. Given the value of the old counter, when a key is accessed.","groupName":"RedisConfig"},{"name":"redisStreamMaxBytes","type":"string","label":"Stream node: Max. bytes","defaultValue":"4096","required":false,"visibleRule":"operation = create && redisVersion = REDIS50","helpMarkDown":"`stream-node-max-bytes`: Using this configuration it is possible to configure how big a single node can be in bytes.","groupName":"RedisConfig"},{"name":"redisStreamMaxEntries","type":"string","label":"Stream node: Max. entries","defaultValue":"100","required":false,"visibleRule":"operation = create && redisVersion = REDIS50","helpMarkDown":"`stream-node-max-entries`: Using this configuration it is possible to configure the maximum number of items it may contain before switching to a new node when appending new stream entries.","groupName":"RedisConfig"},{"name":"instanceDataProtectionMode","type":"radio","label":"Data Protection mode","defaultValue":"LIMITED","required":false,"options":{"LIMITED":"Protected with data loss control","FORCED":"Without data loss control (force data loss)"},"visibleRule":"operation = failover","helpMarkDown":"Initiates a failover of the master node to current replica node for a specific **STANDARD** tier Cloud Memorystore for Redis instance."},{"name":"waitOperation","type":"boolean","label":"Wait for long running operation","defaultValue":false,"required":false,"helpMarkDown":"If enabled, pipeline will wait until resource be modified, instead of just scheduling an operation."}],"OutputVariables":[{"name":"RedisHost","description":"Hostname or IP address of the exposed Redis endpoint used by clients to connect to the service."},{"name":"RedisPort","description":"The port number of the exposed Redis endpoint."},{"name":"RedisCurrentLocation","description":"The current zone where the Redis endpoint is placed."}],"minimumAgentVersion":"2.144.0","execution":{"Node10":{"target":"main.js","argumentFormat":""}},"messages":{}}
