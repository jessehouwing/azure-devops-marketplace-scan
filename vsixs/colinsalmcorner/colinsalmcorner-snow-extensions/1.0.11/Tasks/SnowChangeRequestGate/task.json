{"id":"4f5855b9-bdfe-4816-a6b9-f3601fd353a9","name":"Check Service Now Change Request status.","friendlyName":"Change Request Status","description":"Check Service Now Change Request status.","author":"Colin Dembovsky (colinsalmcorner)","helpMarkDown":"Speficy the following: <ul><li>The ServiceNow endpoint</li><li>The CR number (or variable with the CR number)</li><li>The state the CR should be in to cause this gate to pass (e.g. Implement)</li></ul>","category":"Deploy","version":{"Major":1,"Minor":0,"Patch":"11"},"visibility":["Build","Release"],"runsOn":["Server","ServerGate"],"preview":true,"groups":[{"name":"extension","displayName":"Extension","isExpanded":true}],"instanceNameFormat":"Wait for Change Request $(crNumber) to be in state $(validState)","inputs":[{"name":"connectedServiceName","type":"connectedService:ServiceNow","label":"Service Now endpoint","required":true,"helpMarkDown":"Service Now endpoint connection."},{"name":"crNumber","type":"string","label":"Change Request number","defaultValue":"","required":true,"helpMarkDown":"Change Request number to check."},{"name":"validState","type":"string","label":"State","defaultValue":"Implement","helpMarkDown":"State that the CR should be in to pass the gate.","required":true}],"execution":{"HttpRequest":{"Execute":{"EndpointId":"$(connectedServiceName)","EndpointUrl":"$(endpoint.url)/api/now/table/change_request?sysparm_query=number=$(crNumber)&sysparm_fields=state&sysparm_display_value=true","Method":"GET","Body":"","Headers":"{\"Content-Type\":\"application/json\"}","WaitForCompletion":"false","Expression":"eq(jsonpath('$.result[0].state')[0], '$(validState)')"}}}}
